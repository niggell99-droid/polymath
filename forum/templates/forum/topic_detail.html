{% extends "core/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'core/assets/css/forum.css' %}?v=1">

<section class="community-header small-header"
    style="background: transparent; padding-top: 2rem; margin-bottom: 2rem; border: none;">
    <div class="container">
        <p class="kicker" style="margin-bottom: 1rem;"><a href="{% url 'forum:topic_list' %}"
                style="text-decoration: none; color: var(--muted);">‚Üê Retour au Forum</a></p>
        <h1
            style="font-size: 2.5rem; background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            {{ topic.name }}</h1>
        <p style="font-size: 1.1rem; color: var(--muted); max-width: 800px;">{{ topic.description }}</p>

        <div style="margin-top: 2rem;">
            <a href="#" class="cta small-cta" style="border-radius: 8px;">+ Nouveau Sujet</a>
        </div>
    </div>
</section>

<div class="container" style="min-height: 60vh; padding-bottom: 4rem;">

    <div class="thread-list-container">
        {% for thread in threads %}
        <a href="{{ thread.get_absolute_url }}" class="thread-item {% if thread.is_pinned %}pinned{% endif %}">
            <img src="{% if thread.starter.profil.avatar %}{{ thread.starter.profil.avatar.url }}{% else %}{% static 'core/assets/icons/default_user.svg' %}{% endif %}"
                alt="Avatar" class="thread-avatar">

            <div class="thread-main">
                <span class="thread-title">
                    {% if thread.is_pinned %}üìå {% endif %}
                    {{ thread.title }}
                </span>
                <div class="thread-meta">
                    <span class="author">Par {{ thread.starter.username }}</span>
                    <span>‚Ä¢</span>
                    <span>{{ thread.created_at|timesince }}</span>
                </div>
            </div>

            <div class="thread-stats">
                <span class="stat-badge" style="background: rgba(99, 102, 241, 0.1); color: #818cf8;">{{
                    thread.num_posts }} r√©p.</span>
                <span style="font-size: 0.75rem; color: var(--muted);">{{ thread.views }} vues</span>
            </div>
        </a>
        {% empty %}
        <div style="padding: 3rem; text-align: center; color: var(--muted);">
            <p>Aucun sujet de discussion pour le moment. Soyez le premier √† en lancer un !</p>
        </div>
        {% endfor %}
    </div>

    {% if threads.paginator.num_pages > 1 %}
    <nav class="pagination" aria-label="Pagination des sujets"
        style="margin-top: 3rem; display: flex; justify-content: center; gap: 0.5rem;">
        {% if threads.has_previous %}
        <a href="?page={{ threads.previous_page_number }}" class="cta-button secondary" style="width: auto;">&laquo;
            Pr√©c√©dent</a>
        {% endif %}

        {% for num in threads.paginator.page_range %}
        {% if num == threads.number %}
        <span class="cta-button" style="width: auto; background: var(--accent); color: white;">{{ num }}</span>
        {% else %}
        <a href="?page={{ num }}" class="cta-button secondary" style="width: auto;">{{ num }}</a>
        {% endif %}
        {% endfor %}

        {% if threads.has_next %}
        <a href="?page={{ threads.next_page_number }}" class="cta-button secondary" style="width: auto;">Suivant
            &raquo;</a>
        {% endif %}
    </nav>
    {% endif %}

</div>
{% endblock content %}