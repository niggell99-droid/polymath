{% extends "core/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'core/assets/css/forum.css' %}?v=3">

<!-- Community Header with Premium Tabs -->
<header class="community-header">
    <div class="container">
        <h1>Communaut√© Polymath</h1>
        <p>Espace d'√©change, d'actualit√©s et de direct. Rejoignez les ing√©nieurs qui construisent le futur.</p>

        <div class="community-tabs">
            <button class="tab-btn active" onclick="openTab(event, 'tab-forum')">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    style="margin-right: 6px; vertical-align: -3px;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
                Forum
            </button>
            <button class="tab-btn" onclick="openTab(event, 'tab-actu')">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    style="margin-right: 6px; vertical-align: -3px;">
                    <path
                        d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2" />
                    <path d="M18 14h-8" />
                    <path d="M15 18h-5" />
                    <path d="M10 6h8v4h-8V6Z" />
                </svg>
                Actualit√©s
            </button>
            <button class="tab-btn" onclick="openTab(event, 'tab-live')">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    style="margin-right: 6px; vertical-align: -3px;">
                    <path d="m22 8-6 4 6 4V8Z" />
                    <rect width="14" height="12" x="2" y="6" rx="2" ry="2" />
                </svg>
                Live Stream
            </button>
        </div>
    </div>
</header>

<div class="container" style="min-height: 60vh;">

    <!-- TAB 1: FORUM TOPICS -->
    <div id="tab-forum" class="tab-content">
        <div class="forum-grid">
            {% for topic in topics %}
            <a href="{{ topic.get_absolute_url }}" class="topic-card">
                <div class="topic-icon-placeholder">
                    <span>#</span>
                </div>
                <h2>{{ topic.name }}</h2>
                <p class="description">{{ topic.description|truncatechars:100 }}</p>
                <div class="topic-stats">
                    <span><strong>{{ topic.num_threads }}</strong> sujets</span>
                    <span><strong>{{ topic.num_posts }}</strong> messages</span>
                </div>
            </a>
            {% empty %}
            <div style="grid-column: 1/-1; text-align: center; color: var(--muted); padding: 4rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
                    style="opacity: 0.3; margin-bottom: 1rem;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
                <p style="font-size: 1.1rem;">Aucun th√®me configur√© pour le moment.</p>
                <p style="font-size: 0.9rem; opacity: 0.7;">Revenez bient√¥t pour d√©couvrir nos discussions !</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- TAB 2: ACTU (ACTUALIT√âS) -->
    <div id="tab-actu" class="tab-content" style="display: none;">
        <div class="actu-grid">
            <div class="feed-main">
                <!-- Article 1 -->
                <div class="news-card">
                    <div class="news-image"
                        style="background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #6366f1 100%); display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                            stroke="rgba(255,255,255,0.3)" stroke-width="1">
                            <path d="M12 2a4 4 0 0 0-4 4v8a4 4 0 0 0 8 0V6a4 4 0 0 0-4-4Z" />
                            <path d="M12 18.5a6.5 6.5 0 0 1-6.5-6.5v-2" />
                            <path d="M12 18.5a6.5 6.5 0 0 0 6.5-6.5v-2" />
                            <line x1="12" y1="22" x2="12" y2="18.5" />
                        </svg>
                    </div>
                    <div class="news-content">
                        <span class="news-tag">Technologie</span>
                        <h3>Les avanc√©es majeures de l'IA en 2025</h3>
                        <p style="color: var(--muted); margin-bottom: 1.5rem; line-height: 1.7;">Un r√©sum√© des
                            breakthroughs techniques de cette ann√©e, de GPT-5 aux nouveaux mod√®les de vision par
                            ordinateur.</p>
                        <a href="#" class="cta small-cta">Lire la suite ‚Üí</a>
                    </div>
                </div>

                <!-- Article 2 -->
                <div class="news-card">
                    <div class="news-image"
                        style="background: linear-gradient(135deg, #10b981 0%, #3b82f6 50%, #06b6d4 100%); display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                            stroke="rgba(255,255,255,0.3)" stroke-width="1">
                            <path d="M12 2L2 7l10 5 10-5-10-5Z" />
                            <path d="m2 17 10 5 10-5" />
                            <path d="m2 12 10 5 10-5" />
                        </svg>
                    </div>
                    <div class="news-content">
                        <span class="news-tag">√âv√©nement</span>
                        <h3>Hackathon Polymath : Les r√©sultats</h3>
                        <p style="color: var(--muted); margin-bottom: 1.5rem; line-height: 1.7;">Bravo √† l'√©quipe
                            "Neural Net" pour leur victoire √©crasante avec leur projet de drone autonome bas√© sur la
                            vision IA.</p>
                        <a href="#" class="cta small-cta">Voir les projets ‚Üí</a>
                    </div>
                </div>

                <!-- Article 3 -->
                <div class="news-card">
                    <div class="news-image"
                        style="background: linear-gradient(135deg, #f59e0b 0%, #ef4444 50%, #ec4899 100%); display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                            stroke="rgba(255,255,255,0.3)" stroke-width="1">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M8 14s1.5 2 4 2 4-2 4-2" />
                            <line x1="9" y1="9" x2="9.01" y2="9" />
                            <line x1="15" y1="9" x2="15.01" y2="9" />
                        </svg>
                    </div>
                    <div class="news-content">
                        <span class="news-tag">Communaut√©</span>
                        <h3>Nouveau : Le programme de mentorat Polymath</h3>
                        <p style="color: var(--muted); margin-bottom: 1.5rem; line-height: 1.7;">D√©couvrez notre nouveau
                            programme de mentorat pour accompagner les ing√©nieurs juniors dans leur parcours
                            professionnel.</p>
                        <a href="#" class="cta small-cta">En savoir plus ‚Üí</a>
                    </div>
                </div>
            </div>

            <aside class="trending-sidebar">
                <h4>üî• Tendances</h4>
                <div class="trending-item">
                    <small>#Robotique</small>
                    <p>Boston Dynamics d√©voile Atlas 2.0</p>
                </div>
                <div class="trending-item">
                    <small>#SpaceX</small>
                    <p>Starship : Succ√®s du vol orbital</p>
                </div>
                <div class="trending-item">
                    <small>#Python</small>
                    <p>Django 6.0 est disponible</p>
                </div>
                <div class="trending-item">
                    <small>#Hardware</small>
                    <p>Apple M4 Ultra : Benchmarks r√©v√©l√©s</p>
                </div>
                <div class="trending-item">
                    <small>#OpenSource</small>
                    <p>Linux 7.0 : Ce qui change</p>
                </div>
            </aside>
        </div>
    </div>

    <!-- TAB 3: LIVE -->
    <div id="tab-live" class="tab-content" style="display: none;">
        <div class="live-player">
            <div class="offline-state">
                <div class="offline-icon">üì°</div>
                <h2>Le stream est hors ligne</h2>
                <p>Prochain live : <strong>Mardi 20h00 - Q&A Technique</strong></p>
                <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem;">
                    <button class="cta">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" style="margin-right: 6px; vertical-align: -3px;">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                            <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                        </svg>
                        M'avertir
                    </button>
                    <button class="cta secondary">Voir le calendrier</button>
                </div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
            <div class="replays-section">
                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 1.5rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" style="margin-right: 8px; vertical-align: -4px;">
                        <polygon points="5 3 19 12 5 21 5 3" />
                    </svg>
                    Derniers replays
                </h3>
                <div style="display: flex; gap: 1.5rem; overflow-x: auto; padding-bottom: 1rem;">
                    <div class="replay-card">
                        <div class="replay-thumbnail" style="background: linear-gradient(135deg, #f97316, #ea580c);">
                        </div>
                        <h4>Introduction √† Rust</h4>
                        <small>Il y a 2 jours ‚Ä¢ 1h23min</small>
                    </div>
                    <div class="replay-card">
                        <div class="replay-thumbnail" style="background: linear-gradient(135deg, #8b5cf6, #6366f1);">
                        </div>
                        <h4>D√©bat : IA vs D√©veloppeurs</h4>
                        <small>Il y a 1 semaine ‚Ä¢ 2h05min</small>
                    </div>
                    <div class="replay-card">
                        <div class="replay-thumbnail" style="background: linear-gradient(135deg, #10b981, #059669);">
                        </div>
                        <h4>Workshop Django Avanc√©</h4>
                        <small>Il y a 2 semaines ‚Ä¢ 1h45min</small>
                    </div>
                </div>
            </div>
            <div class="live-chat-placeholder">
                <div style="text-align: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1" style="opacity: 0.3; margin-bottom: 1rem;">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                    <p style="margin: 0;">Le tchat sera activ√© pendant le live</p>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;

        // Hide all tab content
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        // Remove active class from all buttons
        tablinks = document.getElementsByClassName("tab-btn");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        // Show the current tab, and add an "active" class to the button that opened the tab
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const tab = urlParams.get('tab');

        if (tab === 'actu') {
            document.querySelector('.tab-btn[onclick*="tab-actu"]').click();
        } else if (tab === 'live') {
            document.querySelector('.tab-btn[onclick*="tab-live"]').click();
        }
    });
</script>
{% endblock content %}