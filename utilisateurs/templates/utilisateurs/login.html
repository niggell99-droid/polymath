{% extends "core/base.html" %}
{% load static %}

{% block title %}Connexion - Polymath{% endblock title %}

{% block content %}
<link rel="stylesheet" href="{% static 'core/assets/css/auth.css' %}?v=1">

<div class="auth-page-container">
    <div class="auth-bg-blob blob-1"></div>
    <div class="auth-bg-blob blob-2"></div>

    <div class="auth-card">
        <div class="auth-header">
            <img src="{% static 'core/assets/img/logo/polymath_1.png' %}" alt="Polymath Logo" class="auth-logo">
            <h2>Connexion</h2>
            <p>Connectez-vous pour continuer.</p>
        </div>

        <form method="post" class="auth-form">
            {% csrf_token %}

            {% if form.non_field_errors %}
            <div class="form-errors"
                style="background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.5); border-radius: 8px; padding: 0.8rem; margin-bottom: 1.5rem; color: #fca5a5;">
                {% for error in form.non_field_errors %}
                <p style="margin:0; font-size:0.9rem;">{{ error }}</p>
                {% endfor %}
            </div>
            {% endif %}

            {% for field in form %}
            <div class="form-group">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field }}
                {% if field.errors %}
                {% for error in field.errors %}
                <small style="color: #fca5a5; font-size: 0.8rem; display: block; margin-top: 0.4rem;">{{ error
                    }}</small>
                {% endfor %}
                {% endif %}
            </div>
            {% endfor %}

            <button type="submit" class="auth-cta">Se connecter</button>

            {% if next %}
            <input type="hidden" name="next" value="{{ next }}" />
            {% endif %}
        </form>

        <div class="auth-footer">
            <p>Pas encore de compte ? <a href="{% url 'register' %}">Créer un compte</a></p>
        </div>

        {# Social Login Section (Requires django-allauth) #}
        {% load socialaccount %}
        <div class="social-login-separator">
            <span>Ou continuer avec</span>
        </div>

        <div class="social-login-buttons">
            <!-- Note: Configure SocialApps in Admin to use provider_login_url -->
            <a href="#" class="social-btn google" title="Nécessite configuration Admin">
                Google
            </a>
            <a href="#" class="social-btn facebook" title="Nécessite configuration Admin">
                Facebook
            </a>
            <a href="#" class="social-btn apple" title="Nécessite configuration Admin">
                Apple
            </a>
            {% comment %}
            Original Tags (Uncomment after DB Config):
            <a href="{% provider_login_url 'google' %}" ...>Google</a>
            <a href="{% provider_login_url 'facebook' method='oauth2' %}" ...>Facebook</a>
            {% endcomment %}
        </div>
    </div>
</div>
{% endblock content %}

{% block footer %}
{# Footer hidden on auth pages #}
{% endblock footer %}

{% block secondary_nav %}{% endblock %}